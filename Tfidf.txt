collaborative filtering with temporal dynamics yehuda koren yahoo! research, haifa, israel yehuda abstract customer preferences for products are drifting over time. product perception and popularity are constantly changing as new selection emerges. similarly, customer inclinations are evolving, leading them to ever redefine their taste. thus, modeling temporal dynamics should be a key when designing recommender systems or general customer preference models. however, this raises unique challenges. within the ecosystem intersecting multiple products and customers, many different characteristics are shifting simultaneously, while many of them influence each other and often those shifts are delicate and associated with a few data instances. this distinguishes the problem from concept drift explorations, where mostly a single concept is tracked. classical timewindow or instancedecay approaches cannot work, as they lose too much signal when discarding data instances. a more sensitive approach is required, which can make better distinctions between transient effects and long term patterns. the paradigm we offer is creating a model tracking the time changing behavior throughout the life span of the data. this allows us to exploit the relevant components of all data instances, while discarding only what is modeled as being irrelevant. accordingly, we revamp two leading collaborative filtering recommendation approaches. evaluation is made on a large movie rating dataset by netflix. results are encouraging and better than those previously reported on this dataset. categories and subject descriptors h.2.8 [ database management ]: database applicationsdata mining general terms algorithms keywords collaborative filtering, recommender systems, concept drift 1. introduction modeling time drifting data is a central problem in data mining. often, data is changing over time, and up to date modeling should be continuously updated to reflect its present nature. the analysis of such data needs to find the right balance between discounting temporary effects that have very low impact on future behavior, while capturing longerterm trends that reflect the inherent nature of the data. this led to many works on the problem, which is also widely known as concept drift ; see e.g. [15, 25]. modeling temporal changes in customer preferences brings unique challenges. one kind of concept drift in this setup is the emergence of new products or services that change the focus of customers. related to this are seasonal changes, or specific holidays, which lead to characteristic shopping patterns. all those changes influence the whole population, and are within the realm of traditional studies on concept drift. however, many of the changes in user behavior are driven by localized factors. for example, a change in the family structure can drastically change shopping patterns. likewise, individuals gradually change their taste in movies and music. all those changes cannot be captured by methods that seek a global concept drift. instead, for each customer we are looking at different types of concept drifts, each occurs at a distinct time frame and is driven towards a different direction. the need to model time changes at the level of each individual significantly reduces the amount of available data for detecting such changes. thus we should resort to more accurate techniques than those that suffice for modeling global changes. for example, it would no longer be adequate to abandon or simply underweight far in time user transactions. the signal that can be extracted from those past actions might be invaluable for understanding the customer herself or be indirectly useful to modeling other customers. yet, we need to distill long term patterns while discounting transient noise. this requires the learning algorithm to keep track of multiple changing concepts. in addition the typically low amount of data instances associated with individual customers calls for more concise and efficient learning methods, which maximize the utilization of signal in the data. the third approach is based on ensemble learning , which maintains a family of predictors that together produce the final outcome. as for ensemble learning, having multiple models, each of which considers only a fraction of the total behavior may miss those global patterns that can be identified only when considering the full scope of user behavior. we introduce a single new parameter for each user called a so that we get our first definition of a timedependent userbias: b t b a dev t 7 this offers a simple linear model for approximating a drifting behavior, which requires learning two parameters per user: b and a . learning is done by a stochastic gradient descent algorithm running 2030 iterations, with l 0 . this leads to a model, which will be denoted as timesvd , where the prediction rule is as follows: ^ r t you b t b t q p t r you y 14 the exact definitions of the time drifting parameters b t , b t and p t were given in 6,9 and 13. learning is performed by minimizing the associated squared error function on the training set using a regularized stochastic gradient descent algorithm. learning process should make sure that they capture unbiased long term values, without being too affected from drifting aspects. 002 , and step size learning rate of 0.005. an exception is the update of the exponent b , where we are using a much smaller step size of 10 . a lesson is that addressing temporal dynamics in the data can have a more significant impact on accuracy than designing more complex learning algorithms. learning those weights would equally benefit from all ratings by a user. many works were published in the two kdd workshops dedicated to that dataset [3, 23]. in an itemitem neighborhood model, we showed how the more fundamental relations among items can be revealed by learning how influence between two items rated by a user decays over time. 24th annual international conference on machine learning , pp. [23] a. tuzhilin, y. koren, j. bennett, c. elkan and d. lemire eds.. workshop on large scale recommender systems and the netflix prize in conjunction with kdd'08 , 2008. learning in the presence of concept drift and hidden contexts.